# План улучшения системы аутентификации

## Цель
Модернизация системы аутентификации до уровня, близкого к продакшену, с базовой защитой данных и улучшенным UX.

## Основные задачи

### 1. Добавление паролей
Реализовать обязательное поле пароля при регистрации. Пароль должен содержать минимум 8 символов, включать буквы и цифры. При логине проверять пароль вместе с именем/фамилией.

### 2. Безопасное хранение паролей
Использовать bcrypt для хеширования паролей. Никогда не хранить пароли в открытом виде. Добавить поле password_digest в таблицу users.

### 3. Валидация уникальности пользователей
Проверять уникальность комбинации имени и фамилии при регистрации. Показывать ошибку если пользователь уже существует. Добавить индекс для быстрого поиска.

### 4. Валидация обязательных полей
Добавить валидацию на уровне модели для всех полей. Показывать ошибки валидации прямо в форме регистрации. Подсвечивать поля с ошибками красным цветом.

### 5. Улучшенная обработка ошибок
Показывать конкретные ошибки валидации в формах. Не перенаправлять при ошибках, а рендерить форму с ошибками. Добавить flash-сообщения для успешных операций.

### 6. Защита от CSRF
Включить защиту от CSRF атак через Rails токены. Добавить authenticity_token во все формы. Проверять токены в контроллерах.

### 7. Базовое логирование
Логировать попытки входа и регистрации. Записывать IP адрес и время операций. Добавить простой механизм для отслеживания подозрительной активности.

### 8. Улучшенный UX форм
Добавить индикаторы загрузки при отправке форм. Показывать прогресс заполнения полей. Реализовать автозаполнение для повторных попыток.

### 9. Базовая защита от брутфорса
Ограничить количество попыток входа с одного IP. Блокировать IP на 15 минут после 5 неудачных попыток. Показывать предупреждение о блокировке.

### 10. Валидация возраста
Ограничить возраст пользователей от 18 до 65 лет. Показывать ошибку при попытке зарегистрироваться с неподходящим возрастом. Добавить валидацию на клиенте и сервере.

## Технические требования
- Использовать Rails стандарты безопасности
- Минимальные зависимости, только необходимые гемы
- Сохранить существующую архитектуру
- Обратная совместимость с текущими данными
